<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Puppet Class: r_profile::puppet::master::license
  
    &mdash; Documentation by YARD 0.9.9
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "puppet_classes::r_profile::puppet::master::license";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../puppet_class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (r)</a> &raquo;
    <span class='title'><span class='object_link'>Puppet Classes</span></span>
     &raquo; 
    <span class="title">r_profile::puppet::master::license</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="../puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Puppet Class: r_profile::puppet::master::license</h1>
<div class="box_info">
  
  
  <dl>
    <dt>Defined in:</dt>
    <dd>
      manifests/puppet/master/license.pp
    </dd>
  </dl>
</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">
    
<p>R_profile::Puppet::Master::License</p>

<p>Install a puppet license key onto the puppet Master. This works by
symlinking the license.key file from your control repository to the correct
location on the puppet master. To upgrade or alter your license
information, just update the file in the control repository (production
branch) and then deploy to the master as usual.</p>

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_include'>include</span> <span class='id identifier rubyid_r_pofile'>r_pofile</span><span class='op'>::</span><span class='id identifier rubyid_puppet'>puppet</span><span class='op'>::</span><span class='id identifier rubyid_master'>master</span><span class='op'>::</span><span class='id identifier rubyid_license'>license</span></code></pre>
    
  </div>


</div><div class="method_details_list">
  <table class="source_code">
    <tr>
      <td>
        <pre class="lines">


12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre>
      </td>
      <td>
        <pre class="code"><span class="info file"># File 'manifests/puppet/master/license.pp', line 12</span>

class r_profile::puppet::master::license {

  # puppet_enterprise module contains a resource to read and write the same file
  # which leaves us with only exec or resource collectors to do what we need to:
  # if !pe_empty($license_content) { # &lt;-- the content of the file to write
  #                                        read previously using file(...)
  #   file { $puppet_enterprise::params::dest_license_key_path: # &lt;-- same file
  #     ensure  =&gt; present,
  #     content =&gt; $license_content, # &lt;-- same content
  #     mode    =&gt; &#39;0644&#39;,
  #   }
  # }
  # This is of-course needed because the console might be on another system to
  # the puppet master (split installs)

  $license_source = &quot;/etc/puppetlabs/code/environments/production/license.key&quot;
  $license_target = &quot;/etc/puppetlabs/license.key&quot;

  # Copy in a licence file if diff says its non-existant or different.  We must
  # run after the code above otherwise we will be stuck in a race condition
  # where the file can never be updated
  exec { &quot;copy pe license.key content&quot;:
    command =&gt; &quot;cp ${license_source} ${license_target}&quot;,
    unless  =&gt; &quot;diff ${license_source} ${license_target}&quot;,
    path    =&gt; [&quot;/usr/bin&quot;, &quot;/bin&quot;],
    require =&gt; Class[&quot;puppet_enterprise::license&quot;],
  }
}</pre>
      </td>
    </tr>
  </table>
</div>
</div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>