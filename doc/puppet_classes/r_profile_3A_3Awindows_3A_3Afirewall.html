<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Puppet Class: r_profile::windows::firewall
  
    &mdash; Documentation by YARD 0.9.16
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "puppet_classes::r_profile::windows::firewall";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../puppet_class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (r)</a> &raquo;
    <span class='title'><span class='object_link'>Puppet Classes</span></span>
     &raquo; 
    <span class="title">r_profile::windows::firewall</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="../puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Puppet Class: r_profile::windows::firewall</h1>
<div class="box_info">
  
  
  <dl>
    <dt>Defined in:</dt>
    <dd>
      manifests/windows/firewall.pp
    </dd>
  </dl>
</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">
    <p>R_profile::Windows::Firewall</p>

<p>Manage the windows advanced firewall.</p>

<p>Features:</p>

<ul>
<li>Global settings</li>
<li>Per-profile settings</li>
<li>Enable/disable rulegroups by name</li>
<li>Mange firewall rules</li>
</ul>

<p>Items to create are grouped into base and non-base to allow easy management in Hiera. Items in non-base can override
those in base.</p>

  </div>
</div>


<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>turning off all firewalls</p>
</div></p>
      
      <pre class="example code"><code>r_profile::windows::firewall::profiles:
  private:
    state: off
  public:
    state: off
  domain:
    state: off</code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Ensuring firewall rules</p>
</div></p>
      
      <pre class="example code"><code>r_profile::windows::firewall::rules:
  &#39;Windows Remote Management HTTP-In&#39;:
    direction: &#39;in&#39;
    action: &#39;allow&#39;
    enabled: &#39;yes&#39;
    protocol: &#39;TCP&#39;
    localport: 5985
    remoteport: &#39;any&#39;
    description: &#39;Inbound rule for Windows Remote Management via WS-Management. [TCP 5985]&#39;
  &#39;IIS Web Server&#39;:
    direction: &#39;in&#39;
    action: &#39;allow&#39;
    enabled: &#39;yes&#39;
    protocol: &#39;TCP&#39;
    localport: 80
    remoteport: &#39;any&#39;
    description: &#39;Inbound rule for IIS Web Server. [TCP 80]&#39;</code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Configuring per-profile settings</p>
</div></p>
      
      <pre class="example code"><code>r_profile::windows::firewall::profiles:
  private:
    filename: &#39;%systemroot%\system32\logfiles\firewall\pfirewall.log&#39;
    firewallpolicy: &#39;blockinbound,allowoutbound&#39;
    inboundusernotification: &#39;disable&#39;
    logallowedconnections: &#39;disable&#39;
    logdroppedconnections: &#39;disable&#39;
    maxfilesize: &#39;4096&#39;
    remotemanagement: &#39;disable&#39;
    state: &#39;on&#39;
    unicastresponsetomulticast: &#39;enable&#39;</code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Configuring global firewall settings</p>
</div></p>
      
      <pre class="example code"><code>r_profile::windows::firewall::global:
  authzcomputergrp: &#39;none&#39;
  authzusergrp: &#39;none&#39;
  defaultexemptions:
    - &#39;neighbordiscovery&#39;
    - &#39;dhcp&#39;
  forcedh: &#39;yes&#39;
  ipsecthroughnat: &#39;serverbehindnat&#39;
  keylifetime: &#39;485min,0sess&#39;
  saidletimemin: &#39;6&#39;
  secmethods: &#39;dhgroup2:aes128-sha1,dhgroup2:3des-sha1&#39;
  statefulftp: &#39;disable&#39;
  statefulpptp: &#39;disable&#39;
  strongcrlcheck: &#39;1&#39;</code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Enabling a group of rules</p>
</div></p>
      
      <pre class="example code"><code>r_profile::windows::firewall::group:
  &quot;file and printer sharing&quot;:
    enabled: &quot;yes&quot;</code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Purging unmanaged rules (use with caution!)</p>
</div></p>
      
      <pre class="example code"><code>r_profile::windows::firewall::purge_rules: true</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>base_profiles</span>
      
      
        <span class='type'>(<tt>Hash[String, Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Base profile settings (see examples)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>profiles</span>
      
      
        <span class='type'>(<tt>Hash[String, Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Override profile settings (see examples)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>base_rules</span>
      
      
        <span class='type'>(<tt>Hash[String, Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Base rules (see examples)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>rules</span>
      
      
        <span class='type'>(<tt>Hash[String, Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Override rules (see examples)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>base_global</span>
      
      
        <span class='type'>(<tt>Hash[String, Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Base global settings (see examples)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>global</span>
      
      
        <span class='type'>(<tt>Hash[String, Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Override global settings (see examples)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>base_groups</span>
      
      
        <span class='type'>(<tt>Hash[String, Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Base group settings (see examples)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>groups</span>
      
      
        <span class='type'>(<tt>Hash[String, Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Override group settings (see examples)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>purge_rules</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p><code>true</code> to purge all unmanaged firewall rules, otherwise
leave existing rules in place</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://forge.puppet.com/geoffwilliams/windows_firewall" target="_parent" title="https://forge.puppet.com/geoffwilliams/windows_firewall">https://forge.puppet.com/geoffwilliams/windows_firewall</a></li>
    
  </ul>

</div><div class="method_details_list">
  <table class="source_code">
    <tr>
      <td>
        <pre class="lines">


91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135</pre>
      </td>
      <td>
        <pre class="code"><span class="info file"># File 'manifests/windows/firewall.pp', line 91</span>

class r_profile::windows::firewall(
    Hash[String, Hash]  $base_profiles  = {},
    Hash[String, Hash]  $profiles       = {},
    Hash[String, Hash]  $base_rules     = {},
    Hash[String, Hash]  $rules          = {},
    Hash[String, Hash]  $base_global    = {},
    Hash[String, Hash]  $global         = {},
    Hash[String, Hash]  $base_groups    = {},
    Hash[String, Hash]  $groups         = {},
    Boolean             $purge_rules    = false,
) {

  resources { &quot;windows_firewall_rule&quot;:
    purge =&gt; $purge_rules,
  }

  deep_merge($base_profiles, $profiles).each |$key, $opts| {
    windows_firewall_profile { $key:
      * =&gt; $opts,
    }
  }

  deep_merge($base_rules, $rules).each |$key, $opts| {
    windows_firewall_rule {
      default:
        ensure =&gt; present,
      ;

      $key:
        * =&gt; $opts,
    }
  }

  deep_merge($base_groups, $groups).each |$key, $opts| {
    windows_firewall_group { $key:
      * =&gt; $opts,
    }
  }

  # only need shallow merge for global hash since its only one level deep
  windows_firewall_global { &quot;global&quot;:
    * =&gt; merge($base_global, $global),
  }

}</pre>
      </td>
    </tr>
  </table>
</div>
</div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>